## 常见并发问题

* 非死锁缺陷：违反原子性【加锁】、违反顺序性【条件变量】

* 死锁缺陷：线程之间相互等待，相互之间持有资源，死锁产生有四个必要条件

    * 互斥、持有并等待、非抢占【持有的锁不能被抢占】、循环等待【存在一个环路】

* 阻止死锁就是破坏上面提到的四个必要条件
    * 非循环等待：获取锁提供一个全序，先l1后l2
    * 持有并等待：一个获取不到就全释放
    * 非抢占：已有的资源可以被抢占 
    * 非互斥：无法破坏

* 避免死锁：通过合理的调度避免死锁

* 死锁的检查和恢复：利用死锁检测算法，死锁解除的主要方法有： 
    1) 资源剥夺法。挂起某些死锁进程，并抢占它的资源，将这些资源分配给其他的死锁进程。但应防止被挂起的进程长时间得不到资源，而处于资源匮乏的状态。 
    2) 撤销进程法。强制撤销部分、甚至全部死锁进程并剥夺这些进程的资源。撤销的原则可以按进程优先级和撤销进程代价的高低进行。 
    3) 进程回退法。让一（多）个进程回退到足以回避死锁的地步，进程回退时自愿释放资源而不是被剥夺。要求系统保持进程的历史信息，设置还原点。    